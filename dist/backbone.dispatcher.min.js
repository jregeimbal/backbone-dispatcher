!function(t,e){"function"==typeof define&&define.amd?define(["backbone","underscore"],function(i,n){return t.Backbone.Dispatcher=e(i,n)}):"object"==typeof exports?module.exports=e(require("backbone"),require("underscore")):t.Backbone.Dispatcher=e(t.Backbone,t._)}(this,function(t,e){"use strict";var i=root.Dispatcher,n=function(i){i&&i.actions&&("string"==typeof i.actions?this.createAction(i.actions):this.createActions(i.actions)),Object.defineProperty(this,"_actions",{enumerable:!1,value:{}}),e.extend(this._actions,t.Events),this.initialize.apply(this,arguments)};return n.extend=t.Model.extend,n.VERSION="0.0.5",n.noConflict=function(){return root.Dispatcher=i,this},n.prototype={initialize:function(){},_prepareAction:function(t,i){var n={};if(e.isString(t)){if(n.name=t,i)if(e.isFunction(i))n.beforeEmit=i;else for(var o in i)i.hasOwnProperty(o)&&(n[o]=i[o])}else n=t;return n},createAction:function(t,e){var i,n=this._prepareAction(t,e),o=this,r=function(t){o.dispatch(n.name,t)},c=function(t){n.beforeEmit(t,function(t){r(t)})},s=function(t){return function(e){n.shouldEmit(e)&&t(e)}};i=n.shouldEmit?s(n.beforeEmit?c:r):n.beforeEmit?c:r,Object.defineProperty(this,n.name,{enumerable:!1,value:i})},createActions:function(t){for(var e in t)this.createAction(t[e])},register:function(t,e,i){i=i||t,this._actions.on(t,e[i].bind(e))},registerStore:function(t,e,i){i=i||t;for(var n=0;n<t.length;n++)this.register(t[n],e,i[n])},dispatch:function(t,e){this._actions.trigger(t,e)}},n});